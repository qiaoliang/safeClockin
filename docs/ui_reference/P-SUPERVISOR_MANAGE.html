<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>安全守护 - 我的监督人</title>
    <script src="https://unpkg.byted-static.com/coze/space_ppt_lib/1.0.3-alpha.12/lib/tailwindcss.js"></script>
    <script src="https://unpkg.byted-static.com/fortawesome/fontawesome-free/6.7.2/js/all.min.js" data-auto-replace-svg="nest"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#FAE9DB',
                        secondary: '#F48224', 
                        accent: '#624731',
                        success: '#10B981',
                        warning: '#F59E0B',
                        danger: '#EF4444'
                    },
                    fontFamily: {
                        sans: ['-apple-system', 'BlinkMacSystemFont', 'Segoe UI', 'Roboto', 'sans-serif']
                    },
                    boxShadow: {
                        'card': '0 4px 12px rgba(0, 0, 0, 0.08)',
                        'button': '0 2px 8px rgba(244, 130, 36, 0.3)'
                    }
                }
            }
        }
    </script>
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #FAE9DB 0%, #F8E0D0 100%);
        }
        
        .invite-button {
            background: linear-gradient(135deg, #F48224 0%, #E8741A 100%);
            box-shadow: 0 4px 16px rgba(244, 130, 36, 0.4);
            transition: all 0.3s ease;
        }
        
        .invite-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(244, 130, 36, 0.5);
        }
        
        .status-bar {
            background: linear-gradient(135deg, #1F2937 0%, #374151 100%);
        }
        
        .supervisor-card {
            background: linear-gradient(135deg, #FFFFFF 0%, #F9FAFB 100%);
            transition: all 0.3s ease;
        }
        
        .supervisor-card:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.1);
        }
        
        .pending-card {
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            border-left: 4px solid #F59E0B;
        }
        
        .approved-card {
            background: linear-gradient(135deg, #F0FDF4 0%, #DCFCE7 100%);
            border-left: 4px solid #10B981;
        }
        
        .modal-overlay {
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
        }
        
        .modal-content {
            animation: modalSlideIn 0.3s ease-out;
        }
        
        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>
<body class="bg-gray-50 font-sans">
    <!-- iOS状态栏 -->
    <div id="status-bar" class="status-bar text-white text-sm flex justify-between items-center px-4 py-1">
        <div class="flex items-center space-x-1">
            <span>9:41</span>
        </div>
        <div class="flex items-center space-x-1">
            <i class="fas fa-signal text-xs"></i>
            <i class="fas fa-wifi text-xs"></i>
            <i class="fas fa-battery-three-quarters text-xs"></i>
        </div>
    </div>

    <!-- 主容器 -->
    <div id="main-container" class="min-h-screen gradient-bg">
        <!-- 顶部导航栏 -->
        <header id="page-header" class="flex items-center justify-between px-6 py-4 bg-white bg-opacity-80 backdrop-blur-sm">
            <button id="back-btn" class="w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center">
                <i class="fas fa-arrow-left text-gray-600"></i>
            </button>
            <h1 id="page-title" class="text-xl font-bold text-accent">我的监督人</h1>
            <div class="w-10"></div> <!-- 占位元素，保持标题居中 -->
        </header>

        <!-- 邀请监督人按钮 -->
        <section id="invite-section" class="px-6 mb-6">
            <button id="invite-supervisor-btn" class="invite-button w-full py-4 rounded-2xl text-white font-semibold text-lg flex items-center justify-center space-x-3">
                <i class="fas fa-user-plus text-xl"></i>
                <span>邀请监督人</span>
            </button>
        </section>

        <!-- 待处理申请列表 -->
        <section id="pending-applications" class="px-6 mb-6">
            <h2 id="pending-title" class="text-lg font-semibold text-accent mb-4 flex items-center">
                <i class="fas fa-clock text-warning mr-2"></i>
                待处理申请
            </h2>
            <div id="pending-list" class="space-y-4">
                <!-- 待处理申请项 -->
                <div id="pending-item-1" class="pending-card rounded-2xl p-5 shadow-card">
                    <div class="flex items-center justify-between mb-3">
                        <div class="flex items-center space-x-4">
                            <img id="pending-avatar-1" 
                                 src="https://s.coze.cn/image/7UFUzMHSVBs/" 
                                 alt="李小明头像" 
                                 data-category="人物"
                                 class="w-12 h-12 rounded-full border-2 border-white shadow-md">
                            <div>
                                <h3 id="pending-name-1" class="font-semibold text-gray-800">李小明</h3>
                                <p id="pending-relation-1" class="text-sm text-gray-600">申请成为您的监督人</p>
                                <p id="pending-time-1" class="text-xs text-gray-500 mt-1">申请时间：2024-01-15 14:30</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <span id="pending-status-1" class="px-3 py-1 bg-warning bg-opacity-20 text-warning text-sm rounded-full">待处理</span>
                        </div>
                    </div>
                    <div id="pending-actions-1" class="flex space-x-3 pt-3 border-t border-yellow-200">
                        <button id="approve-btn-1" class="flex-1 py-2 bg-success text-white text-sm font-medium rounded-xl hover:bg-green-600 transition-colors">
                            <i class="fas fa-check mr-1"></i>
                            同意
                        </button>
                        <button id="reject-btn-1" class="flex-1 py-2 bg-gray-200 text-gray-700 text-sm font-medium rounded-xl hover:bg-gray-300 transition-colors">
                            <i class="fas fa-times mr-1"></i>
                            拒绝
                        </button>
                    </div>
                </div>

                <div id="pending-item-2" class="pending-card rounded-2xl p-5 shadow-card">
                    <div class="flex items-center justify-between mb-3">
                        <div class="flex items-center space-x-4">
                            <img id="pending-avatar-2" 
                                 src="https://s.coze.cn/image/GblrQykQ17E/" 
                                 alt="王阿姨头像" 
                                 data-category="人物"
                                 class="w-12 h-12 rounded-full border-2 border-white shadow-md">
                            <div>
                                <h3 id="pending-name-2" class="font-semibold text-gray-800">王阿姨</h3>
                                <p id="pending-relation-2" class="text-sm text-gray-600">申请成为您的监督人</p>
                                <p id="pending-time-2" class="text-xs text-gray-500 mt-1">申请时间：2024-01-15 10:15</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <span id="pending-status-2" class="px-3 py-1 bg-warning bg-opacity-20 text-warning text-sm rounded-full">待处理</span>
                        </div>
                    </div>
                    <div id="pending-actions-2" class="flex space-x-3 pt-3 border-t border-yellow-200">
                        <button id="approve-btn-2" class="flex-1 py-2 bg-success text-white text-sm font-medium rounded-xl hover:bg-green-600 transition-colors">
                            <i class="fas fa-check mr-1"></i>
                            同意
                        </button>
                        <button id="reject-btn-2" class="flex-1 py-2 bg-gray-200 text-gray-700 text-sm font-medium rounded-xl hover:bg-gray-300 transition-colors">
                            <i class="fas fa-times mr-1"></i>
                            拒绝
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- 已同意监督人列表 -->
        <section id="approved-supervisors" class="px-6 mb-6">
            <h2 id="approved-title" class="text-lg font-semibold text-accent mb-4 flex items-center">
                <i class="fas fa-users text-success mr-2"></i>
                我的监督人
            </h2>
            <div id="approved-list" class="space-y-4">
                <!-- 已同意监督人项 -->
                <div id="approved-item-1" class="approved-card rounded-2xl p-5 shadow-card">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-4">
                            <img id="approved-avatar-1" 
                                 src="https://s.coze.cn/image/l6i_KFe3nBI/" 
                                 alt="张女儿头像" 
                                 data-category="人物"
                                 class="w-14 h-14 rounded-full border-2 border-white shadow-md">
                            <div>
                                <h3 id="approved-name-1" class="font-semibold text-gray-800">张女儿</h3>
                                <p id="approved-relation-1" class="text-sm text-gray-600">女儿</p>
                                <p id="approved-time-1" class="text-xs text-gray-500 mt-1">已监督：30天</p>
                            </div>
                        </div>
                        <div class="flex items-center space-x-3">
                            <div class="text-right">
                                <span id="approved-status-1" class="px-3 py-1 bg-success bg-opacity-20 text-success text-sm rounded-full">已同意</span>
                                <p id="approved-count-1" class="text-xs text-gray-500 mt-1">可查看您的打卡记录</p>
                            </div>
                            <button id="remove-btn-1" class="w-8 h-8 rounded-full bg-red-100 flex items-center justify-center hover:bg-red-200 transition-colors" data-supervisor-id="1" data-supervisor-name="张女儿">
                                <i class="fas fa-trash text-danger text-sm"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <div id="approved-item-2" class="approved-card rounded-2xl p-5 shadow-card">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-4">
                            <img id="approved-avatar-2" 
                                 src="https://s.coze.cn/image/ByqPyGExB6U/" 
                                 alt="李儿子头像" 
                                 data-category="人物"
                                 class="w-14 h-14 rounded-full border-2 border-white shadow-md">
                            <div>
                                <h3 id="approved-name-2" class="font-semibold text-gray-800">李儿子</h3>
                                <p id="approved-relation-2" class="text-sm text-gray-600">儿子</p>
                                <p id="approved-time-2" class="text-xs text-gray-500 mt-1">已监督：15天</p>
                            </div>
                        </div>
                        <div class="flex items-center space-x-3">
                            <div class="text-right">
                                <span id="approved-status-2" class="px-3 py-1 bg-success bg-opacity-20 text-success text-sm rounded-full">已同意</span>
                                <p id="approved-count-2" class="text-xs text-gray-500 mt-1">可查看您的打卡记录</p>
                            </div>
                            <button id="remove-btn-2" class="w-8 h-8 rounded-full bg-red-100 flex items-center justify-center hover:bg-red-200 transition-colors" data-supervisor-id="2" data-supervisor-name="李儿子">
                                <i class="fas fa-trash text-danger text-sm"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <div id="approved-item-3" class="approved-card rounded-2xl p-5 shadow-card">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-4">
                            <img id="approved-avatar-3" 
                                 src="https://s.coze.cn/image/sWCd8J8Juto/" 
                                 alt="王邻居头像" 
                                 data-category="人物"
                                 class="w-14 h-14 rounded-full border-2 border-white shadow-md">
                            <div>
                                <h3 id="approved-name-3" class="font-semibold text-gray-800">王邻居</h3>
                                <p id="approved-relation-3" class="text-sm text-gray-600">邻居</p>
                                <p id="approved-time-3" class="text-xs text-gray-500 mt-1">已监督：8天</p>
                            </div>
                        </div>
                        <div class="flex items-center space-x-3">
                            <div class="text-right">
                                <span id="approved-status-3" class="px-3 py-1 bg-success bg-opacity-20 text-success text-sm rounded-full">已同意</span>
                                <p id="approved-count-3" class="text-xs text-gray-500 mt-1">可查看您的打卡记录</p>
                            </div>
                            <button id="remove-btn-3" class="w-8 h-8 rounded-full bg-red-100 flex items-center justify-center hover:bg-red-200 transition-colors" data-supervisor-id="3" data-supervisor-name="王邻居">
                                <i class="fas fa-trash text-danger text-sm"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 空状态提示（当没有监督人时显示） -->
        <div id="empty-state" class="hidden px-6 py-12 text-center">
            <div class="w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
                <i class="fas fa-user-friends text-gray-400 text-2xl"></i>
            </div>
            <h3 class="text-lg font-semibold text-gray-600 mb-2">还没有监督人</h3>
            <p class="text-gray-500 mb-6">邀请您的亲友成为监督人，让他们关心您的日常安全</p>
        </div>
    </div>

    <!-- 移除监督人确认弹窗 -->
    <div id="remove-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center modal-overlay">
        <div id="remove-modal-content" class="modal-content bg-white rounded-2xl p-6 mx-6 w-full max-w-sm">
            <div class="text-center">
                <div class="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-exclamation-triangle text-danger text-2xl"></i>
                </div>
                <h3 id="remove-modal-title" class="text-lg font-semibold text-gray-800 mb-2">确认移除监督人</h3>
                <p id="remove-modal-message" class="text-gray-600 mb-6">确定要移除 <span id="remove-supervisor-name" class="font-medium"></span> 作为您的监督人吗？移除后他们将无法查看您的打卡记录。</p>
                <div class="flex space-x-3">
                    <button id="cancel-remove-btn" class="flex-1 py-3 bg-gray-100 text-gray-700 font-medium rounded-xl hover:bg-gray-200 transition-colors">
                        取消
                    </button>
                    <button id="confirm-remove-btn" class="flex-1 py-3 bg-danger text-white font-medium rounded-xl hover:bg-red-600 transition-colors">
                        确认移除
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 操作成功提示 -->
    <div id="success-toast" class="hidden fixed top-20 left-1/2 transform -translate-x-1/2 bg-success text-white px-6 py-3 rounded-full shadow-lg z-50">
        <div class="flex items-center space-x-2">
            <i class="fas fa-check-circle"></i>
            <span id="success-message">操作成功</span>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            let currentRemoveSupervisorId = null;

            // 返回按钮点击事件
            document.querySelector('#back-btn').addEventListener('click', function() {
                window.location.href = 'P-PROFILE.html';
            });

            // 邀请监督人按钮点击事件
            document.querySelector('#invite-supervisor-btn').addEventListener('click', function() {
                window.location.href = 'P-INVITE_SUPERVISOR.html';
            });

            // 同意申请按钮点击事件
            document.querySelectorAll('[id^="approve-btn-"]').forEach(button => {
                button.addEventListener('click', function() {
                    const pendingId = this.id.split('-')[2];
                    approveApplication(pendingId);
                });
            });

            // 拒绝申请按钮点击事件
            document.querySelectorAll('[id^="reject-btn-"]').forEach(button => {
                button.addEventListener('click', function() {
                    const pendingId = this.id.split('-')[2];
                    rejectApplication(pendingId);
                });
            });

            // 移除监督人按钮点击事件
            document.querySelectorAll('[id^="remove-btn-"]').forEach(button => {
                button.addEventListener('click', function() {
                    currentRemoveSupervisorId = this.dataset.supervisorId;
                    const supervisorName = this.dataset.supervisorName;
                    showRemoveModal(supervisorName);
                });
            });

            // 取消移除按钮点击事件
            document.querySelector('#cancel-remove-btn').addEventListener('click', function() {
                hideRemoveModal();
            });

            // 确认移除按钮点击事件
            document.querySelector('#confirm-remove-btn').addEventListener('click', function() {
                if (currentRemoveSupervisorId) {
                    removeSupervisor(currentRemoveSupervisorId);
                }
            });

            // 点击弹窗背景关闭弹窗
            document.querySelector('#remove-modal').addEventListener('click', function(e) {
                if (e.target === this) {
                    hideRemoveModal();
                }
            });

            // 同意申请函数
            function approveApplication(pendingId) {
                const pendingItem = document.querySelector(`#pending-item-${pendingId}`);
                if (pendingItem) {
                    // 更新UI状态
                    const statusElement = pendingItem.querySelector(`#pending-status-${pendingId}`);
                    statusElement.textContent = '已同意';
                    statusElement.className = 'px-3 py-1 bg-success bg-opacity-20 text-success text-sm rounded-full';
                    
                    // 隐藏操作按钮
                    const actionsElement = pendingItem.querySelector(`#pending-actions-${pendingId}`);
                    actionsElement.style.display = 'none';
                    
                    // 显示成功提示
                    showSuccessToast('已同意申请');
                    
                    // 模拟将申请移至已同意列表（实际应用中会重新加载数据）
                    setTimeout(() => {
                        pendingItem.remove();
                        checkEmptyState();
                    }, 1000);
                }
            }

            // 拒绝申请函数
            function rejectApplication(pendingId) {
                const pendingItem = document.querySelector(`#pending-item-${pendingId}`);
                if (pendingItem) {
                    // 更新UI状态
                    const statusElement = pendingItem.querySelector(`#pending-status-${pendingId}`);
                    statusElement.textContent = '已拒绝';
                    statusElement.className = 'px-3 py-1 bg-gray-200 text-gray-600 text-sm rounded-full';
                    
                    // 隐藏操作按钮
                    const actionsElement = pendingItem.querySelector(`#pending-actions-${pendingId}`);
                    actionsElement.style.display = 'none';
                    
                    // 显示成功提示
                    showSuccessToast('已拒绝申请');
                    
                    // 模拟移除申请项
                    setTimeout(() => {
                        pendingItem.remove();
                        checkEmptyState();
                    }, 1000);
                }
            }

            // 显示移除确认弹窗
            function showRemoveModal(supervisorName) {
                document.querySelector('#remove-supervisor-name').textContent = supervisorName;
                document.querySelector('#remove-modal').classList.remove('hidden');
            }

            // 隐藏移除确认弹窗
            function hideRemoveModal() {
                document.querySelector('#remove-modal').classList.add('hidden');
                currentRemoveSupervisorId = null;
            }

            // 移除监督人函数
            function removeSupervisor(supervisorId) {
                const approvedItem = document.querySelector(`#approved-item-${supervisorId}`);
                if (approvedItem) {
                    // 添加淡出效果
                    approvedItem.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
                    approvedItem.style.opacity = '0';
                    approvedItem.style.transform = 'translateX(-100%)';
                    
                    // 显示成功提示
                    showSuccessToast('已移除监督人');
                    
                    // 移除元素
                    setTimeout(() => {
                        approvedItem.remove();
                        hideRemoveModal();
                        checkEmptyState();
                    }, 300);
                }
            }

            // 检查空状态
            function checkEmptyState() {
                const pendingList = document.querySelector('#pending-list');
                const approvedList = document.querySelector('#approved-list');
                const emptyState = document.querySelector('#empty-state');
                
                if (pendingList.children.length === 0 && approvedList.children.length === 0) {
                    emptyState.classList.remove('hidden');
                } else {
                    emptyState.classList.add('hidden');
                }
            }

            // 显示成功提示
            function showSuccessToast(message) {
                const toast = document.querySelector('#success-toast');
                const messageElement = document.querySelector('#success-message');
                
                messageElement.textContent = message;
                toast.classList.remove('hidden');
                
                setTimeout(() => {
                    toast.classList.add('hidden');
                }, 3000);
            }

            // 模拟实时时间更新
            function updateTime() {
                const now = new Date();
                const timeString = now.toLocaleTimeString('zh-CN', { 
                    hour: '2-digit', 
                    minute: '2-digit',
                    hour12: false 
                });
                document.querySelector('#status-bar span').textContent = timeString;
            }

            updateTime();
            setInterval(updateTime, 60000);
        });
    </script>
</body>
</html>